{
	"name": "Login",
	"events": [
		{
			"eventType": "include",
			"includeSheet": "Global"
		},
		{
			"eventType": "comment",
			"text": "Language"
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-start-of-layout",
					"objectClass": "System",
					"sid": 189025136803109
				}
			],
			"actions": [],
			"sid": 318977582286114,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-two-values",
							"objectClass": "System",
							"sid": 310961397331125,
							"parameters": {
								"first-value": "TextManager.Language",
								"comparison": 0,
								"second-value": "\"hu\""
							}
						}
					],
					"actions": [
						{
							"id": "set-selection",
							"objectClass": "LanguageList",
							"sid": 679807396951435,
							"parameters": {
								"index": "0"
							}
						}
					],
					"sid": 280261143775547
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-two-values",
							"objectClass": "System",
							"sid": 878045375428656,
							"parameters": {
								"first-value": "TextManager.Language",
								"comparison": 0,
								"second-value": "\"en\""
							}
						}
					],
					"actions": [
						{
							"id": "set-selection",
							"objectClass": "LanguageList",
							"sid": 614802932062580,
							"parameters": {
								"index": "1"
							}
						}
					],
					"sid": 116309668715403
				}
			]
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-selection-changed",
					"objectClass": "LanguageList",
					"sid": 907336458132104
				}
			],
			"actions": [],
			"sid": 299653948890253,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-selection",
							"objectClass": "LanguageList",
							"sid": 681967297096764,
							"parameters": {
								"comparison": 0,
								"index": "0"
							}
						}
					],
					"actions": [
						{
							"id": "set-language",
							"objectClass": "TextManager",
							"sid": 168019175796515,
							"parameters": {
								"language": "\"hu\""
							}
						}
					],
					"sid": 337641512069429
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 824036177630269
						},
						{
							"id": "compare-selection",
							"objectClass": "LanguageList",
							"sid": 258161373799174,
							"parameters": {
								"comparison": 0,
								"index": "1"
							}
						}
					],
					"actions": [
						{
							"id": "set-language",
							"objectClass": "TextManager",
							"sid": 410443977880486,
							"parameters": {
								"language": "\"en\""
							}
						}
					],
					"sid": 859954905188599
				},
				{
					"eventType": "block",
					"conditions": [],
					"actions": [
						{
							"callFunction": "LoginRefreshUI",
							"sid": 252771750018303
						}
					],
					"sid": 509343218594314
				}
			]
		},
		{
			"eventType": "comment",
			"text": "Select user"
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-start-of-layout",
					"objectClass": "System",
					"sid": 877169980876251
				}
			],
			"actions": [
				{
					"callFunction": "LoginRefreshUI",
					"sid": 951609946186651
				}
			],
			"sid": 629837966539046
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-selection-changed",
					"objectClass": "LoginUsername",
					"sid": 245943955075643
				}
			],
			"actions": [],
			"sid": 371343418145860,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-selection",
							"objectClass": "LoginUsername",
							"sid": 213481672627861,
							"parameters": {
								"comparison": 0,
								"index": "0"
							}
						}
					],
					"actions": [
						{
							"id": "set-value",
							"objectClass": "Data",
							"sid": 135761818909330,
							"parameters": {
								"path": "\"settings.lastUserUID\"",
								"value": "\"\""
							}
						}
					],
					"sid": 388406501984768
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 753984081821328
						}
					],
					"actions": [
						{
							"id": "set-value",
							"objectClass": "Data",
							"sid": 859447805307624,
							"parameters": {
								"path": "\"settings.lastUserUID\"",
								"value": "LoginUserList.Get(LoginUsername.SelectedIndex-1 & \".UID\")"
							}
						}
					],
					"sid": 164826844666183
				},
				{
					"eventType": "block",
					"conditions": [],
					"actions": [
						{
							"id": "set-item",
							"objectClass": "LocalStorage",
							"sid": 719636137965938,
							"parameters": {
								"key": "\"settings\"",
								"value": "Data.GetAsCompactString(\"settings\")"
							}
						},
						{
							"callFunction": "LoginRefreshUI",
							"sid": 421039724830904
						}
					],
					"sid": 526743551287488
				}
			]
		},
		{
			"functionName": "LoginRefreshUI",
			"functionCopyPicked": false,
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionIsAsync": true,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 621374275041953,
			"children": [
				{
					"eventType": "block",
					"conditions": [],
					"actions": [
						{
							"id": "set-text",
							"objectClass": "Message",
							"sid": 629962017096441,
							"parameters": {
								"text": "\"\""
							}
						},
						{
							"callFunction": "ListUsers",
							"sid": 329100909937845
						},
						{
							"id": "wait-for-previous-actions",
							"objectClass": "System",
							"sid": 363423838527677
						}
					],
					"sid": 671374691301656,
					"children": [
						{
							"eventType": "comment",
							"text": "Refresh users"
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "parse",
									"objectClass": "LoginUserList",
									"sid": 271719445225407,
									"parameters": {
										"data": "APISuccess"
									}
								},
								{
									"id": "clear",
									"objectClass": "LoginUsername",
									"sid": 333102955050440
								},
								{
									"id": "add-item",
									"objectClass": "LoginUsername",
									"sid": 518288024997080,
									"parameters": {
										"text": "TextManager.Translate(\"login.new\")"
									}
								}
							],
							"sid": 327769407443617
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for-each",
									"objectClass": "LoginUserList",
									"sid": 587629513378027,
									"parameters": {
										"path": "\"\""
									}
								}
							],
							"actions": [],
							"sid": 869754453615773,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-value",
											"objectClass": "LoginUserList",
											"sid": 504940339063167,
											"parameters": {
												"path": "LoginUserList.CurrentKey & \".isNeedLogin\"",
												"cmp": 0,
												"value": "0"
											}
										}
									],
									"actions": [
										{
											"id": "add-item",
											"objectClass": "LoginUsername",
											"sid": 708660978352936,
											"parameters": {
												"text": "LoginUserList.Get(LoginUserList.CurrentKey & \".name\")"
											}
										}
									],
									"sid": 702642406710825
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 622045878478377
										}
									],
									"actions": [
										{
											"id": "add-item",
											"objectClass": "LoginUsername",
											"sid": 391837889321977,
											"parameters": {
												"text": "LoginUserList.Get(LoginUserList.CurrentKey & \".name\") & \" (\" & TextManager.Translate(\"login.need-login\") & \")\""
											}
										}
									],
									"sid": 382774740136832
								}
							]
						},
						{
							"eventType": "comment",
							"text": "Select last selected users"
						},
						{
							"eventType": "variable",
							"name": "lastUserIndex",
							"type": "number",
							"initialValue": "0",
							"comment": "",
							"isStatic": false,
							"isConstant": false,
							"sid": 349730705696730
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-value",
									"objectClass": "Data",
									"sid": 409569725509589,
									"parameters": {
										"path": "\"settings.lastUser\"",
										"cmp": 1,
										"value": "\"\""
									}
								}
							],
							"actions": [],
							"sid": 328933826458743,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "for-each",
											"objectClass": "LoginUserList",
											"sid": 563378221175705,
											"parameters": {
												"path": "\"\""
											}
										}
									],
									"actions": [],
									"sid": 603443277677307,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "compare-value",
													"objectClass": "LoginUserList",
													"sid": 330799152342483,
													"parameters": {
														"path": "LoginUserList.CurrentKey & \".UID\"",
														"cmp": 0,
														"value": "Data.Get(\"settings.lastUserUID\")"
													}
												}
											],
											"actions": [
												{
													"id": "set-eventvar-value",
													"objectClass": "System",
													"sid": 348764213562589,
													"parameters": {
														"variable": "lastUserIndex",
														"value": "int(LoginUserList.CurrentKey) +1"
													}
												},
												{
													"id": "stop-loop",
													"objectClass": "System",
													"sid": 386455264533214
												}
											],
											"sid": 830820374408162
										}
									]
								}
							]
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "set-selection",
									"objectClass": "LoginUsername",
									"sid": 835447410232674,
									"parameters": {
										"index": "lastUserIndex"
									}
								}
							],
							"sid": 741450674716094
						},
						{
							"eventType": "comment",
							"text": "Display layout"
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-eventvar",
									"objectClass": "System",
									"sid": 247330092695145,
									"parameters": {
										"variable": "lastUserIndex",
										"comparison": 0,
										"value": "0"
									}
								}
							],
							"actions": [
								{
									"id": "set-layer-visible",
									"objectClass": "System",
									"sid": 273865538992695,
									"parameters": {
										"layer": "\"Create\"",
										"visibility": "visible"
									}
								},
								{
									"id": "set-layer-visible",
									"objectClass": "System",
									"sid": 289146167454994,
									"parameters": {
										"layer": "\"Login\"",
										"visibility": "invisible"
									}
								},
								{
									"id": "set-layer-visible",
									"objectClass": "System",
									"sid": 846265710315030,
									"parameters": {
										"layer": "\"LoginCrypted\"",
										"visibility": "invisible"
									}
								}
							],
							"sid": 964959229259823
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 987246061286288
								},
								{
									"id": "compare-value",
									"objectClass": "LoginUserList",
									"sid": 764994141060796,
									"parameters": {
										"path": "str(lastUserIndex-1) & \".isCrypted\"",
										"cmp": 0,
										"value": "0"
									}
								}
							],
							"actions": [
								{
									"id": "set-layer-visible",
									"objectClass": "System",
									"sid": 972442504828081,
									"parameters": {
										"layer": "\"Create\"",
										"visibility": "invisible"
									}
								},
								{
									"id": "set-layer-visible",
									"objectClass": "System",
									"sid": 766700806110387,
									"parameters": {
										"layer": "\"Login\"",
										"visibility": "visible"
									}
								},
								{
									"id": "set-layer-visible",
									"objectClass": "System",
									"sid": 988495268134732,
									"parameters": {
										"layer": "\"LoginCrypted\"",
										"visibility": "invisible"
									}
								}
							],
							"sid": 501492837914462
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 186370552519735
								}
							],
							"actions": [
								{
									"id": "set-layer-visible",
									"objectClass": "System",
									"sid": 543534355877706,
									"parameters": {
										"layer": "\"Create\"",
										"visibility": "invisible"
									}
								},
								{
									"id": "set-layer-visible",
									"objectClass": "System",
									"sid": 266380502291878,
									"parameters": {
										"layer": "\"Login\"",
										"visibility": "invisible"
									}
								},
								{
									"id": "set-layer-visible",
									"objectClass": "System",
									"sid": 307315703850489,
									"parameters": {
										"layer": "\"LoginCrypted\"",
										"visibility": "visible"
									}
								}
							],
							"sid": 633677515366676
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "set-text",
									"objectClass": "LoginPass",
									"sid": 229585356768223,
									"parameters": {
										"text": "\"\""
									}
								},
								{
									"id": "set-text",
									"objectClass": "LoginCreateUser",
									"sid": 965512746371354,
									"parameters": {
										"text": "\"\""
									}
								},
								{
									"id": "set-text",
									"objectClass": "LoginCreatePass",
									"sid": 922522117622441,
									"parameters": {
										"text": "\"\""
									}
								},
								{
									"id": "set-text",
									"objectClass": "LoginCreatePass2",
									"sid": 928379155784782,
									"parameters": {
										"text": "\"\""
									}
								}
							],
							"sid": 772990688429375
						}
					]
				}
			]
		},
		{
			"eventType": "comment",
			"text": "Login/Create"
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-clicked",
					"objectClass": "Next",
					"sid": 433886673634302
				}
			],
			"actions": [],
			"sid": 448201345730252,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-selection",
							"objectClass": "LoginUsername",
							"sid": 583136104745053,
							"parameters": {
								"comparison": 0,
								"index": "0"
							}
						}
					],
					"actions": [],
					"sid": 428328741310591,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-two-values",
									"objectClass": "System",
									"sid": 203359984592447,
									"parameters": {
										"first-value": "trim(LoginCreateUser.Text)",
										"comparison": 0,
										"second-value": "\"\""
									}
								}
							],
							"actions": [
								{
									"id": "set-text",
									"objectClass": "Message",
									"sid": 786277262488933,
									"parameters": {
										"text": "TextManager.Translate(\"login.create-error3\")"
									}
								}
							],
							"sid": 212238703866068
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 741027574514834
								},
								{
									"id": "compare-text",
									"objectClass": "LoginCreatePass",
									"sid": 187771448589013,
									"parameters": {
										"text": "LoginCreatePass2.Text",
										"case": "case-sensitive"
									},
									"isInverted": true
								}
							],
							"actions": [
								{
									"id": "set-text",
									"objectClass": "Message",
									"sid": 934601662364675,
									"parameters": {
										"text": "TextManager.Translate(\"login.create-error2\")"
									}
								}
							],
							"sid": 498652414671983
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 631473183562104
								}
							],
							"actions": [
								{
									"callFunction": "CreateUser",
									"sid": 775500804441035,
									"parameters": [
										"LoginCreateUser.Text",
										"LoginCreatePass.Text"
									]
								},
								{
									"id": "wait-for-previous-actions",
									"objectClass": "System",
									"sid": 391397483945357
								}
							],
							"sid": 517413667272736,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-eventvar",
											"objectClass": "System",
											"sid": 250985438581308,
											"parameters": {
												"variable": "APIError",
												"comparison": 1,
												"value": "\"\""
											}
										}
									],
									"actions": [
										{
											"id": "set-text",
											"objectClass": "Message",
											"sid": 237243804857033,
											"parameters": {
												"text": "TextManager.Translate(\"login.create-error\")"
											}
										}
									],
									"sid": 574439886750397
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 768486667626293
										}
									],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 543881999414882,
											"parameters": {
												"variable": "CurrentUserUID",
												"value": "APISuccess"
											}
										},
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 407642361989652,
											"parameters": {
												"variable": "CurrentPassword",
												"value": "LoginCreatePass.Text"
											}
										},
										{
											"id": "set-value",
											"objectClass": "Data",
											"sid": 568633667116204,
											"parameters": {
												"path": "\"settings.lastUserUID\"",
												"value": "CurrentUserUID"
											}
										},
										{
											"id": "set-item",
											"objectClass": "LocalStorage",
											"sid": 681340947778363,
											"parameters": {
												"key": "\"settings\"",
												"value": "Data.GetAsCompactString(\"settings\")"
											}
										},
										{
											"id": "wait-for-previous-actions",
											"objectClass": "System",
											"sid": 239232003315561
										},
										{
											"id": "go-to-layout",
											"objectClass": "System",
											"sid": 139425310593310,
											"parameters": {
												"layout": "Main"
											}
										}
									],
									"sid": 959733672573024
								}
							]
						}
					]
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 130477768888367
						}
					],
					"actions": [],
					"sid": 579389059252141,
					"children": [
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"callFunction": "ListTasks",
									"sid": 957175069998284,
									"parameters": [
										"LoginUserList.Get((LoginUsername.SelectedIndex-1)  & \".UID\")",
										"LoginPass.Text"
									]
								},
								{
									"id": "wait-for-previous-actions",
									"objectClass": "System",
									"sid": 132583999651517
								}
							],
							"sid": 375412012648855,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-eventvar",
											"objectClass": "System",
											"sid": 496143085172392,
											"parameters": {
												"variable": "APIError",
												"comparison": 1,
												"value": "\"\""
											}
										}
									],
									"actions": [
										{
											"callFunction": "LoginRefreshUI",
											"sid": 622461075294529
										},
										{
											"id": "wait-for-previous-actions",
											"objectClass": "System",
											"sid": 875119432592408
										},
										{
											"id": "set-text",
											"objectClass": "Message",
											"sid": 776479734235993,
											"parameters": {
												"text": "TextManager.Translate(\"login.login-error\")"
											}
										}
									],
									"sid": 469576878394996
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 652179134119730
										}
									],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 137958953079704,
											"parameters": {
												"variable": "CurrentUserUID",
												"value": "LoginUserList.Get((LoginUsername.SelectedIndex-1)  & \".UID\")"
											}
										},
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 734445114256564,
											"parameters": {
												"variable": "CurrentPassword",
												"value": "LoginPass.Text"
											}
										},
										{
											"id": "go-to-layout",
											"objectClass": "System",
											"sid": 860005506675476,
											"parameters": {
												"layout": "Main"
											}
										}
									],
									"sid": 560863234783300
								}
							]
						}
					]
				}
			]
		},
		{
			"eventType": "comment",
			"text": "Delete"
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "LoginDelete",
			"description": "",
			"isActiveOnStart": true,
			"children": [
				{
					"eventType": "variable",
					"name": "isDeleteClicked",
					"type": "boolean",
					"initialValue": "false",
					"comment": "",
					"isStatic": true,
					"isConstant": false,
					"sid": 493315686536250
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-clicked",
							"objectClass": "LoginDelete",
							"sid": 652230097901619
						}
					],
					"actions": [],
					"sid": 896513732118225,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-selection",
									"objectClass": "LoginUsername",
									"sid": 467050134061891,
									"parameters": {
										"comparison": 1,
										"index": "0"
									}
								}
							],
							"actions": [],
							"sid": 497749224076120,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-boolean-eventvar",
											"objectClass": "System",
											"sid": 989241127415211,
											"parameters": {
												"variable": "isDeleteClicked"
											},
											"isInverted": true
										}
									],
									"actions": [
										{
											"id": "set-key-value",
											"objectClass": "LoginDelete",
											"sid": 525568641643758,
											"behaviorType": "TextManager",
											"parameters": {
												"key-value": "\"login.delete-confirm\""
											}
										},
										{
											"id": "set-boolean-eventvar",
											"objectClass": "System",
											"sid": 963538780950878,
											"parameters": {
												"variable": "isDeleteClicked",
												"value": "true"
											}
										}
									],
									"sid": 455053207047747
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 801880423481804
										}
									],
									"actions": [],
									"sid": 999240406723787,
									"children": [
										{
											"eventType": "block",
											"conditions": [],
											"actions": [
												{
													"callFunction": "DeleteUser",
													"sid": 101729395148019,
													"parameters": [
														"LoginUserList.Get((LoginUsername.SelectedIndex-1)  & \".UID\")"
													]
												},
												{
													"id": "wait-for-previous-actions",
													"objectClass": "System",
													"sid": 132736384274057
												},
												{
													"callFunction": "LoginRefreshUI",
													"sid": 983364924909397
												},
												{
													"id": "wait-for-previous-actions",
													"objectClass": "System",
													"sid": 343263780054273
												},
												{
													"id": "set-key-value",
													"objectClass": "LoginDelete",
													"sid": 541548359841085,
													"behaviorType": "TextManager",
													"parameters": {
														"key-value": "\"login.delete\""
													}
												},
												{
													"id": "set-boolean-eventvar",
													"objectClass": "System",
													"sid": 612747375450665,
													"parameters": {
														"variable": "isDeleteClicked",
														"value": "false"
													}
												}
											],
											"sid": 893478646524542
										}
									]
								}
							]
						}
					]
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "on-any-touch-end",
							"objectClass": "Touch",
							"sid": 666720779585851
						},
						{
							"id": "on-any-click",
							"objectClass": "Mouse",
							"sid": 410201967612550
						}
					],
					"actions": [],
					"sid": 112557260818998,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "cursor-is-over-object",
									"objectClass": "Mouse",
									"sid": 703320911544147,
									"parameters": {
										"object": "LoginDelete"
									},
									"isInverted": true
								},
								{
									"id": "is-touching-object",
									"objectClass": "Touch",
									"sid": 181980197148532,
									"parameters": {
										"object": "LoginDelete"
									},
									"isInverted": true
								}
							],
							"actions": [
								{
									"id": "set-key-value",
									"objectClass": "LoginDelete",
									"sid": 723869897126983,
									"behaviorType": "TextManager",
									"parameters": {
										"key-value": "\"login.delete\""
									}
								},
								{
									"id": "set-boolean-eventvar",
									"objectClass": "System",
									"sid": 636603843032216,
									"parameters": {
										"variable": "isDeleteClicked",
										"value": "false"
									}
								}
							],
							"sid": 932681680283118
						}
					],
					"isOrBlock": true
				}
			],
			"sid": 344655385918366
		}
	],
	"sid": 955884483134718
}